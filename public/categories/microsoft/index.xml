<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Microsoft on MikeDixson.com</title>
    <link>https://mikedixson.com/categories/microsoft/</link>
    <description>Recent content in Microsoft on MikeDixson.com</description>
    <generator>Hugo</generator>
    <language>en-gb</language>
    <lastBuildDate>Tue, 27 Nov 2018 13:14:06 +0000</lastBuildDate>
    <atom:link href="https://mikedixson.com/categories/microsoft/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>SOLVED: Windows DHCP – Search for a MAC Address</title>
      <link>https://mikedixson.com/windows-dhcp-search-for-a-mac-address/</link>
      <pubDate>Tue, 27 Nov 2018 13:14:06 +0000</pubDate>
      <guid>https://mikedixson.com/windows-dhcp-search-for-a-mac-address/</guid>
      <description>&lt;p&gt;This is a super succinct method of finding a mac address on a Window s DHCP server: &lt;a href=&#34;https://thewayeye.net/2016/10/8/find-a-mac-microsoft-dhcp&#34;&gt;https://thewayeye.net/2016/10/8/find-a-mac-microsoft-dhcp&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre class=&#34;wp-block-code&#34;&gt;&lt;code&gt;Get-DhcpServerv4Scope | Get-DhcpServerv4Lease -EA SilentlyContinue -ClientId xx-xx-xx-xx-xx-xx&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>Get Boot Time For all computers in an OU – Powershell</title>
      <link>https://mikedixson.com/get-boot-time-for-all-computers-in-an-ou-powershell/</link>
      <pubDate>Tue, 13 Feb 2018 10:26:37 +0000</pubDate>
      <guid>https://mikedixson.com/get-boot-time-for-all-computers-in-an-ou-powershell/</guid>
      <description>&lt;p&gt;I wrote the following script enumerates an OU and then looks up the last boot time for each computer.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/mikedixson/GetLastBootTimeFromOU&#34;&gt;https://github.com/mikedixson/GetLastBootTimeFromOU&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;Note: I’m starting to put any scripts I write on GitHub, this will make it easier for you copy down and easier for me to keep any scripts up to date.&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>Easy GPO Audit Using Powershell</title>
      <link>https://mikedixson.com/easy-gpo-audit-using-powershell/</link>
      <pubDate>Wed, 03 Jan 2018 08:25:44 +0000</pubDate>
      <guid>https://mikedixson.com/easy-gpo-audit-using-powershell/</guid>
      <description>&lt;p&gt;After poking around the Group Policy Objects (GPO) of an infrastructure that was new to me I needed a decent way of producing a quick and useful report on the state of the GPOs.&lt;/p&gt;&#xA;&lt;p&gt;Because the ComputerVersion and UserVersion numbers are listed as two figures, one for AD and one for Sysvol just an export-csv of get-gpo left me with blank ComputerVersion and UserVersion.&lt;/p&gt;&#xA;&lt;p&gt;I found this post: &lt;a href=&#34;https://community.spiceworks.com/topic/551588-get-gpo-userversion-and-computerversion-troubles&#34;&gt;https://community.spiceworks.com/topic/551588-get-gpo-userversion-and-computerversion-troubles&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;By using the following powershell I was able to within minutes provide useful information on the state of the GPOs.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get-gpo -all | select Displayname,ID,Description,GPOStatus,CreationTime,ModificationTime,@{Label=&amp;quot;ComputerVersion&amp;quot;;Expression={$_.computer.dsversion}},@{Label=&amp;quot;UserVersion&amp;quot;;Expression={$_.user.dsversion}}| export-csv gpo-audit.csv&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;A small bit of conditional formatting later and we can see that the Domain GPO has a large amount of user setting edits and should be split into a user only GPO and a computer GPO (I won’t go into where these GPOs should be linked at this stage).&lt;a href=&#34;http://mikedixson.com/2018/01/easy-gpo-audit-using-powershell/gpo_audit_snip/&#34; rel=&#34;attachment wp-att-720&#34;&gt;&lt;br /&gt; &lt;img loading=&#34;lazy&#34; class=&#34;aligncenter size-large wp-image-720&#34; src=&#34;http://mikedixson.com/wp-content/uploads/2018/01/GPO_audit_snip-1024x128.png&#34; alt=&#34;A snipping of an excel spreadsheet with colour coding providing meaning to the figures&#34; width=&#34;604&#34; height=&#34;76&#34; srcset=&#34;https://mikedixson.com/wp-content/uploads/2018/01/GPO_audit_snip-1024x128.png 1024w, https://mikedixson.com/wp-content/uploads/2018/01/GPO_audit_snip-300x38.png 300w, https://mikedixson.com/wp-content/uploads/2018/01/GPO_audit_snip-768x96.png 768w, https://mikedixson.com/wp-content/uploads/2018/01/GPO_audit_snip.png 1111w&#34; sizes=&#34;(max-width: 604px) 100vw, 604px&#34; /&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.vecteezy.com/free-vector/policy&#34;&gt;Policy Vectors by Vecteezy&lt;/a&gt;&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>Powershell Script to Check if a Website is Up and if Not Restart a service</title>
      <link>https://mikedixson.com/powershell-script-to-check-if-a-website-is-up-and-if-not-restart-a-service/</link>
      <pubDate>Mon, 05 Oct 2015 10:53:49 +0000</pubDate>
      <guid>https://mikedixson.com/powershell-script-to-check-if-a-website-is-up-and-if-not-restart-a-service/</guid>
      <description>&lt;p&gt;The below PowerShell script check the website is responding AND &lt;strong&gt;doesn’t&lt;/strong&gt; returns a certain string, if either test is failed then a Windows service is restarted, forcefully if necessary after a grace period.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Please note&lt;/strong&gt; that I have modified this script to make it more easily customisable and not had the opportunity to test with the strings switched out for the variables. The logic is sound and works.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Also note&lt;/strong&gt; that this is one code block (word press isn’t a fan of it being one though :-/&lt;br&gt;&#xA;You can download the file here &lt;a href=&#34;http://mikedixson.com/2015/10/powershell-script-to-check-if-a-website-is-up-and-if-not-restart-a-service/checkwebsiteisup-ps1/&#34; rel=&#34;attachment wp-att-594&#34;&gt;CheckWebsiteIsUp.ps1&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$webClient = new-object System.Net.WebClient&amp;lt;br /&amp;gt; $webClient.Headers.Add(&amp;quot;user-agent&amp;quot;, &amp;quot;PowerShell Script&amp;quot;)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;&amp;lt;br /&amp;gt; #Initialising&amp;lt;br /&amp;gt; $webClient = new-object System.Net.WebClient&amp;lt;br /&amp;gt; $webClient.Headers.Add(&amp;quot;user-agent&amp;quot;, &amp;quot;PowerShell Script&amp;quot;)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;#Variables to modify&amp;lt;br /&amp;gt; $output = &amp;quot;&amp;quot; #Define output variable&amp;lt;br /&amp;gt; $serviceName = &amp;quot;confluence&amp;quot; #Short windows service name&amp;lt;br /&amp;gt; $smtpServerName = &amp;quot;smtp.website.com&amp;quot; #SMTP Server name&amp;lt;br /&amp;gt; $fromEmailAddress = &amp;quot;servername@website.com&amp;quot; #Email address for mail to come from/reply address&amp;lt;br /&amp;gt; $stringToCheckFor = &amp;quot;The service is unavailable&amp;quot; #String to check for. Note that this will be searched for with wildcards either side&amp;lt;br /&amp;gt; $startTime = get-date&amp;lt;br /&amp;gt; $output = $webClient.DownloadString(&amp;quot;http://www.website.com/&amp;quot;) #Modify this url to be the url you want to test&amp;lt;br /&amp;gt; $endTime = get-date&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;#Main workload&amp;lt;br /&amp;gt; #The below checks for the string &amp;quot;The service is unavailable&amp;quot; from your website and if found forcefully restarts the defined service&amp;lt;br /&amp;gt; if ($output -And $output -notlike &amp;quot;*$stringToCheckFor*&amp;quot;) {&amp;lt;br /&amp;gt; &amp;quot;Site Up`t`t&amp;quot; + $startTime.DateTime + &amp;quot;`t`t&amp;quot; + ($endTime - $startTime).TotalSeconds + &amp;quot; seconds&amp;quot;&amp;lt;br /&amp;gt; } else {&amp;lt;br /&amp;gt; &amp;quot;Fail`t`t&amp;quot; + $startTime.DateTime + &amp;quot;`t`t&amp;quot; + ($endTime - $startTime).TotalSeconds + &amp;quot; seconds&amp;quot;&amp;lt;br /&amp;gt; stop-service $serviceName -force&amp;lt;br /&amp;gt; &amp;quot;Stop Service Command Sent&amp;quot;&amp;lt;br /&amp;gt; $svc = Get-Service $serviceName&amp;lt;br /&amp;gt; $svc.WaitForStatus(&#39;Stopped&#39;,&#39;00:05:00&#39;) #Waits for service to enter stopped state or 5 mins has passed, whichever is first&amp;lt;br /&amp;gt; get-service $serviceName | where-object {$_.Status -eq &amp;quot;Stopped&amp;quot;} | restart-service #Belt and braces but only restarts the service if it&#39;s stopped.&amp;lt;br /&amp;gt; $svc.WaitForStatus(&#39;Running&#39;,&#39;00:01:00&#39;) #Waits for service to enter Running state or 1 minute to pass, whichever is first&amp;lt;br /&amp;gt; Send-MailMessage -From “intranet@rave.ac.uk” -To “$fromEmailAddress” -SmtpServer “$smtpServerName” -Subject &amp;quot;$serviceName Service Restarted&amp;quot; -Body &amp;quot;$serviceName Service Restarted&amp;quot; #Sends an email alert that the service was restarted&amp;lt;br /&amp;gt; }&lt;/code&gt;&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>Solution: Wacom Intuos Pen and Touch Pressure Sensitivity in Photoshop</title>
      <link>https://mikedixson.com/solution-wacom-intuos-pen-and-touch-pressure-sensitivity-in-photoshop/</link>
      <pubDate>Mon, 31 Aug 2015 18:16:15 +0000</pubDate>
      <guid>https://mikedixson.com/solution-wacom-intuos-pen-and-touch-pressure-sensitivity-in-photoshop/</guid>
      <description>&lt;p&gt;So in order to use pressure sensitivity in Photoshop you &lt;strong&gt;MUST&lt;/strong&gt; have &lt;strong&gt;Use Windows Ink&lt;/strong&gt; enabled.&lt;/p&gt;&#xA;&lt;figure id=&#34;attachment_579&#34; aria-describedby=&#34;caption-attachment-579&#34; style=&#34;width: 564px&#34; class=&#34;wp-caption aligncenter&#34;&gt;&lt;a href=&#34;http://mikedixson.com/2015/08/solution-wacom-intuos-pen-and-touch-pressure-sensitivity-in-photoshop/usewindowslink/&#34; rel=&#34;attachment wp-att-579&#34;&gt;&lt;img loading=&#34;lazy&#34; class=&#34;size-full wp-image-579&#34; src=&#34;https://mikedixson.com/wp-content/uploads/2015/08/useWindowsLink.png&#34; alt=&#34;Wacom Control Panel use Windows Link&#34; width=&#34;564&#34; height=&#34;498&#34; srcset=&#34;https://mikedixson.com/wp-content/uploads/2015/08/useWindowsLink.png 564w, https://mikedixson.com/wp-content/uploads/2015/08/useWindowsLink-300x265.png 300w&#34; sizes=&#34;(max-width: 564px) 100vw, 564px&#34; /&gt;&lt;/a&gt;&lt;figcaption id=&#34;caption-attachment-579&#34; class=&#34;wp-caption-text&#34;&gt;Wacom Control Panel use Windows Link&lt;/figcaption&gt;&lt;/figure&gt;&#xA;&lt;p&gt;But without it no pressure sensitivity at all and in Brush Dynamics the pen control option just gives you an exclamation mark next to it.&lt;/p&gt;&#xA;&lt;p&gt;Update: I’ve upgraded one of my machines to Windows 10 and Windows Ink doesn’t seem necessary on that one for pressure sensitivity.&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>Reinstalling TCP/IP Network Stack Windows 7</title>
      <link>https://mikedixson.com/reinstalling-tcpip-network-stack-windows-7/</link>
      <pubDate>Thu, 08 Jan 2015 16:34:28 +0000</pubDate>
      <guid>https://mikedixson.com/reinstalling-tcpip-network-stack-windows-7/</guid>
      <description>&lt;p&gt;Taken from [https://pandapow.co/how-to/win-reset-adapter/] – These instructions were used by a colleague recently when his network stack was b0rK3n. Running both the reset for tcp4 and tcp6 seemed to be key. Just resetting 4 did not resolve his issue.&lt;/p&gt;&#xA;&lt;h1 id=&#34;open-the-command-prompt-as-an-administrator&#34;&gt;Open the Command Prompt as an administrator&lt;/h1&gt;&#xA;&lt;p&gt;Run the commands in this document in a Command Prompt that has been started “*as administrator*”.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Click the *Start menu*&lt;/li&gt;&#xA;&lt;li&gt;Type *cmd* in the search box,&lt;/li&gt;&#xA;&lt;li&gt;*right-click* the cmd item at the top and select *Run as administrator* from the menu&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h1 id=&#34;reset-winsock&#34;&gt;Reset Winsock&lt;/h1&gt;&#xA;&lt;p&gt;Resets Winsock Catalog to a clean state.&lt;br&gt;&#xA;&lt;code&gt;netsh winsock reset&lt;/code&gt;&lt;br&gt;&#xA;*Restart computer*&lt;/p&gt;&#xA;&lt;h1 id=&#34;reset-firewall&#34;&gt;Reset Firewall&lt;/h1&gt;&#xA;&lt;p&gt;This command restores the Windows Firewall with Advanced Security policy to the default policy.&lt;br&gt;&#xA;&lt;code&gt;netsh advfirewall reset&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h1 id=&#34;reset-branchcache&#34;&gt;Reset BranchCache&lt;/h1&gt;&#xA;&lt;p&gt;Resets the BranchCache service. Flushes the local cache. Every configuration parameter of BranchCache will be reset to its default value.&lt;br&gt;&#xA;&lt;code&gt;netsh branchcache reset&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h1 id=&#34;reset-ipv4&#34;&gt;Reset IPv4&lt;/h1&gt;&#xA;&lt;p&gt;Resets TCP/IP and related components to a clean state.&lt;br&gt;&#xA;&lt;code&gt;netsh int ip reset&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h1 id=&#34;reset-ipv6&#34;&gt;Reset IPv6&lt;/h1&gt;&#xA;&lt;p&gt;Resets IPv6 configuration state.&lt;br&gt;&#xA;&lt;code&gt;netsh int ipv6 reset&lt;/code&gt;&lt;/p&gt;&#xA;</description>
    </item>
  </channel>
</rss>